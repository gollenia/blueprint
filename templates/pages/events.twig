{% extends "master.twig" %}

{% block content %}
    
        
{% include "partials/header.twig" with {'post': post, 'headerimage': true} %}     
   
<div x-data="{filter: window.location.hash.substring(1)}" class="bg-gray-100">
    <section class="bg-gray-300">
        <div class="content">
            <ul class="tabs">
                <li class="tabs__item" :class="{'bg-gray-100': filter === ''}" @click="filter = ''">{{ __("All", "ctx-theme") }}</li>
                {% for term in terms %}
                    <li class="tabs__item" :class="{'bg-gray-100': filter === '{{term.slug}}'}" @click="filter = '{{term.slug}}'">{{term.name}}</li>
                {% endfor %}
            </ul>
        </div>
    </section>
    <section class="py-16">
        <div class="content grid md:grid--columns-2 xl:grid--columns-3 grid--gap-12">        
            {% for event in events %}
                <div 
                    x-show="filter == '' || [{% for term in event.terms('event-categories') %}'{{term.slug}}'{% endfor %}].includes(filter)" 
                    class="card card--hover card--primary card--shadow {{ site.option("dbem_thumbnails_enabled") == 1 ? 'card--no-image' : 'card--image-top' }} bg-white {{ loop.first ? "card--first" }} {{ loop.last ? "card--last" }} card--hover {% for term in event.get_terms('event-categories') %}{{term.slug}}{% endfor %}"
                    x-transition:enter="transition ease-out duration-300"
                    x-transition:enter-start="opacity-0 transform scale-90"
                    x-transition:enter-end="opacity-100 transform scale-100"
                    x-transition:leave="transition ease-in duration-300"
                    x-transition:leave-start="opacity-100 transform scale-100"
                    x-transition:leave-end="opacity-0 transform scale-90"
                >
                
                    
                    {% if site.option("dbem_thumbnails_enabled") != 1 %} 
                    <a href="/{{site.option('dbem_cp_events_slug')}}/{{event.slug}}" class="card__image">
                        <img src="{{ event.thumbnail.src('large') }}" alt="{{ event.thumbnail.post_excerpt ?: event.thumbnail.post_title }}">      
                    </a>
                    {% endif %}
                    <div class="card__content">
                        {% if event.terms('event-categories') %}<span class="card__label">{{event.terms('event-categories')|first.name}}</span>{% endif %}
                        <a href="/{{site.option('dbem_cp_events_slug')}}/{{event.slug}}" class="card__title">{{event.post_title}}</a>
                        <div class="card__subtitle">
                            {% if event._event_start_date == event._event_end_date %}
                            {{ event._event_start_date|date("j. F Y") }} {{ __("from", "ctx-theme") }} {{ event._event_start_time|date(site.option("dbem_time_format"), false) }} {{ __("to", "ctx-theme") }} {{ event._event_end_time|date(site.option("dbem_time_format"), false) }} {{ __("o'clock", "ctx-theme") }}
                            {% else %}
                            {{ event._event_start_date|date("j. F") }} {{ __("to", "ctx-theme") }} {{ event._event_end|date("j. F Y") }}  
                            {% endif %}
                        </div>
                        <p class="card__text">{{event.post_excerpt|excerpt(20)}}</p>

                        <span class="card__footer">
                            <div class="card__actions">
                                <a class="button button--primary button--link" href="/{{site.option('dbem_cp_events_slug')}}/{{event.slug}}">Details</a>
                            </div>
                            
                        </span>
                    </div>
                </div>
            {% endfor %}
        </article>
    </section>
    <div class="">{{ function( 'apply_filters', 'the_content', post.content ) }}</div>

    </div>
</div>  
{% endblock %}
