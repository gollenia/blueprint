{% if hasLightbox %}
<div x-data="{ imgModal : false, imgModalSrc : '', imgModalDesc : '' }">
    <template @img-modal.window="imgModal = true; imgModalSrc = $event.detail.imgModalSrc; imgModalDesc = $event.detail.imgModalDesc;" x-if="imgModal">
      <div x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform scale-90" x-transition:enter-end="opacity-100 transform scale-100" x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100 transform scale-100" x-transition:leave-end="opacity-0 transform scale-90" x-on:click.away="imgModalSrc = ''" class="p-2 fixed w-full h-100 inset-0 z-50 overflow-hidden flex justify-center items-center bg-black bg-opacity-75">
        <div @click="imgModal = ''" class="flex absolute bg-blur bg-opacity-75 bg-gray-transparent flex-col inset-0 overflow-auto">
          <div class="z-50">
            <button @click="imgModal = ''" class="float-right pt-2 pr-2 outline-none focus:outline-none">
              <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z">
                </path>
              </svg>
            </button>
          </div>
          <div class="p-2">
            <img :alt="imgModalSrc" class="object-contain h-2/3-screen" :src="imgModalSrc">
            <p x-text="imgModalDesc" class="text-center text-white"></p>
          </div>
        </div>
      </div>
    </template>
  </div>
{% endif %}

{% if image.subtype == 'svg+xml' %}
  <figure style="width: {{width}}%; {{alignment == "center" ? "margin: auto"}}">
  {{ source(function('wp_get_original_image_path', image.id), ignore_missing = true) }}
  </figure>
{% else %}
<div style="margin-top: {{marginShift}}" class="{{alignment == "center" ? "m-auto"}} image relative overflow-hidden" x-data="{showOverlay : false}" @mouseover="showOverlay = true" @mouseout="showOverlay = false">
    {% if hasOverlay %}
        <div 
            x-transition:enter-end="opacity-100 -translate-y-0 transform" 
            x-transition:leave="transition ease-in duration-300" 
            x-transition:enter-start="opacity-0 translate-y-full transform" 
            x-transition:enter="transition ease-out duration-300" 
            x-transition:leave-start="opacity-100 transform -translate-y-0" 
            x-transition:leave-end="opacity-100 transform translate-y-full" 
            class="absolute bg-blur bg-opacity-75 rounded-tr-md inset-x-0 mr-5 bottom-0 height  bg-{{overlayColor}}-500 px-5 py-5" 
            x-show="showOverlay"
        >
            {{overlayText}}
        </div>
    {% endif %}
    {% if hasLightbox %}
    <a @click="$dispatch('img-modal', {  imgModalSrc: '{{image.url}}', imgModalDesc: '{{lightboxText}}' })" class="cursor-pointer">
    {% endif %}

        <img style="width: {{width}}%;" alt="{{image.description}}" class="object-fit inline-block {{round ? "rounded-full" : "rounded-tl-md rounded-br-md lg:rounded-tl-lg lg:rounded-br-lg"}}" src="{{round ? image.sizes.qlarge.url : image.url}}">
    
    
    {{ hasLightbox ? "</a>" : "" }}
</div>
{% endif %}